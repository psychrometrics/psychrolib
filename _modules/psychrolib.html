<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>psychrolib &#8212; PsychroLib  documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href="https://github.com/psychrometrics/psychrolib"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


<div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../api_docs.html">
          PsychroLib</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for psychrolib</h1><div class="highlight"><pre>
<span></span><span class="c1"># PsychroLib (version 2.5.0) (https://github.com/psychrometrics/psychrolib).</span>
<span class="c1"># Copyright (c) 2018-2020 The PsychroLib Contributors for the current library implementation.</span>
<span class="c1"># Copyright (c) 2017 ASHRAE Handbook — Fundamentals for ASHRAE equations and coefficients.</span>
<span class="c1"># Licensed under the MIT License.</span>

<span class="sd">&quot;&quot;&quot; psychrolib.py</span>

<span class="sd">Contains functions for calculating thermodynamic properties of gas-vapor mixtures</span>
<span class="sd">and standard atmosphere suitable for most engineering, physical and meteorological</span>
<span class="sd">applications.</span>

<span class="sd">Most of the functions are an implementation of the formulae found in the</span>
<span class="sd">2017 ASHRAE Handbook - Fundamentals, in both International System (SI),</span>
<span class="sd">and Imperial (IP) units. Please refer to the information included in</span>
<span class="sd">each function for their respective reference.</span>

<span class="sd">Example</span>
<span class="sd">    &gt;&gt;&gt; import psychrolib</span>
<span class="sd">    &gt;&gt;&gt; # Set the unit system, for example to SI (can be either psychrolib.SI or psychrolib.IP)</span>
<span class="sd">    &gt;&gt;&gt; psychrolib.SetUnitSystem(psychrolib.SI)</span>
<span class="sd">    &gt;&gt;&gt; # Calculate the dew point temperature for a dry bulb temperature of 25 C and a relative humidity of 80%</span>
<span class="sd">    &gt;&gt;&gt; TDewPoint = psychrolib.GetTDewPointFromRelHum(25.0, 0.80)</span>
<span class="sd">    &gt;&gt;&gt; print(TDewPoint)</span>
<span class="sd">    21.309397163661785</span>

<span class="sd">Copyright</span>
<span class="sd">    - For the current library implementation</span>
<span class="sd">        Copyright (c) 2018-2020 The PsychroLib Contributors.</span>
<span class="sd">    - For equations and coefficients published ASHRAE Handbook — Fundamentals, Chapter 1</span>
<span class="sd">        Copyright (c) 2017 ASHRAE Handbook — Fundamentals (https://www.ashrae.org)</span>

<span class="sd">License</span>
<span class="sd">    MIT (https://github.com/psychrometrics/psychrolib/LICENSE.txt)</span>

<span class="sd">Note from the Authors</span>
<span class="sd">    We have made every effort to ensure that the code is adequate, however, we make no</span>
<span class="sd">    representation with respect to its accuracy. Use at your own risk. Should you notice</span>
<span class="sd">    an error, or if you have a suggestion, please notify us through GitHub at</span>
<span class="sd">    https://github.com/psychrometrics/psychrolib/issues.</span>


<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Global constants</span>
<span class="c1">#######################################################################################################</span>

<span class="n">ZERO_FAHRENHEIT_AS_RANKINE</span> <span class="o">=</span> <span class="mf">459.67</span>
<span class="sd">&quot;&quot;&quot;float: Zero degree Fahrenheit (°F) expressed as degree Rankine (°R)</span>

<span class="sd">    Units:</span>
<span class="sd">        °R</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 39</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">ZERO_CELSIUS_AS_KELVIN</span> <span class="o">=</span> <span class="mf">273.15</span>
<span class="sd">&quot;&quot;&quot;float: Zero degree Celsius (°C) expressed as Kelvin (K)</span>

<span class="sd">    Units:</span>
<span class="sd">        K</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 39</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">R_DA_IP</span> <span class="o">=</span> <span class="mf">53.350</span>
<span class="sd">&quot;&quot;&quot;float: Universal gas constant for dry air (IP version)</span>

<span class="sd">    Units:</span>
<span class="sd">        ft lb_Force lb_DryAir⁻¹ R⁻¹</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">R_DA_SI</span> <span class="o">=</span> <span class="mf">287.042</span>
<span class="sd">&quot;&quot;&quot;float: Universal gas constant for dry air (SI version)</span>

<span class="sd">    Units:</span>
<span class="sd">        J kg_DryAir⁻¹ K⁻¹</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">MAX_ITER_COUNT</span> <span class="o">=</span> <span class="mi">100</span>
<span class="sd">&quot;&quot;&quot;int: Maximum number of iterations before exiting while loops.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">MIN_HUM_RATIO</span> <span class="o">=</span> <span class="mf">1e-7</span>
<span class="sd">&quot;&quot;&quot;float: Minimum acceptable humidity ratio used/returned by any functions.</span>
<span class="sd">          Any value above 0 or below the MIN_HUM_RATIO will be reset to this value.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">FREEZING_POINT_WATER_IP</span> <span class="o">=</span> <span class="mf">32.0</span>
<span class="sd">&quot;&quot;&quot;float: Freezing point of water in Fahrenheit.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">FREEZING_POINT_WATER_SI</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="sd">&quot;&quot;&quot;float: Freezing point of water in Celsius.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">TRIPLE_POINT_WATER_IP</span> <span class="o">=</span> <span class="mf">32.018</span>
<span class="sd">&quot;&quot;&quot;float: Triple point of water in Fahrenheit.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">TRIPLE_POINT_WATER_SI</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="sd">&quot;&quot;&quot;float: Triple point of water in Celsius.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#######################################################################################################</span>
<span class="c1"># Helper functions</span>
<span class="c1">#######################################################################################################</span>

<span class="c1"># Unit system to use.</span>
<div class="viewcode-block" id="UnitSystem"><a class="viewcode-back" href="../api_docs.html#psychrolib.UnitSystem">[docs]</a><span class="k">class</span> <span class="nc">UnitSystem</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Private class not exposed used to set automatic enumeration values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">IP</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">SI</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span></div>

<span class="n">IP</span> <span class="o">=</span> <span class="n">UnitSystem</span><span class="o">.</span><span class="n">IP</span>
<span class="n">SI</span> <span class="o">=</span> <span class="n">UnitSystem</span><span class="o">.</span><span class="n">SI</span>

<span class="n">PSYCHROLIB_UNITS</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">PSYCHROLIB_TOLERANCE</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Tolerance of temperature calculations</span>

<div class="viewcode-block" id="SetUnitSystem"><a class="viewcode-back" href="../api_docs.html#psychrolib.SetUnitSystem">[docs]</a><span class="k">def</span> <span class="nf">SetUnitSystem</span><span class="p">(</span><span class="n">Units</span><span class="p">:</span> <span class="n">UnitSystem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the system of units to use (SI or IP).</span>

<span class="sd">    Args:</span>
<span class="sd">        Units: string indicating the system of units chosen (SI or IP)</span>

<span class="sd">    Notes:</span>
<span class="sd">        This function *HAS TO BE CALLED* before the library can be used</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">PSYCHROLIB_UNITS</span>
    <span class="k">global</span> <span class="n">PSYCHROLIB_TOLERANCE</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Units</span><span class="p">,</span> <span class="n">UnitSystem</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The system of units has to be either SI or IP.&quot;</span><span class="p">)</span>

    <span class="n">PSYCHROLIB_UNITS</span> <span class="o">=</span> <span class="n">Units</span>

    <span class="c1"># Define tolerance on temperature calculations</span>
    <span class="c1"># The tolerance is the same in IP and SI</span>
    <span class="k">if</span> <span class="n">Units</span> <span class="o">==</span> <span class="n">IP</span><span class="p">:</span>
        <span class="n">PSYCHROLIB_TOLERANCE</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="mf">9.</span> <span class="o">/</span> <span class="mf">5.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">PSYCHROLIB_TOLERANCE</span> <span class="o">=</span> <span class="mf">0.001</span>

    <span class="k">if</span> <span class="n">has_numba</span><span class="p">:</span>
        <span class="c1"># Need to recompile functions when the system of units is changed as Numba considers these global variables compile-time constants.</span>
        <span class="c1"># See https://numba.pydata.org/numba-doc/dev/user/faq.html#numba-doesn-t-seem-to-care-when-i-modify-a-global-variable</span>
        <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;isIP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">njit</span><span class="p">(</span><span class="n">isIP</span><span class="o">.</span><span class="n">py_func</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">func_list</span><span class="p">:</span>
            <span class="nb">globals</span><span class="p">()[</span><span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">vectorize</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="GetUnitSystem"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetUnitSystem">[docs]</a><span class="k">def</span> <span class="nf">GetUnitSystem</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UnitSystem</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return system of units in use.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PSYCHROLIB_UNITS</span></div>

<div class="viewcode-block" id="isIP"><a class="viewcode-back" href="../api_docs.html#psychrolib.isIP">[docs]</a><span class="k">def</span> <span class="nf">isIP</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check whether the system in use is IP or SI.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">PSYCHROLIB_UNITS</span> <span class="o">==</span> <span class="n">IP</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">PSYCHROLIB_UNITS</span> <span class="o">==</span> <span class="n">SI</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The system of units has not been defined.&#39;</span><span class="p">)</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Conversion between temperature units</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetTRankineFromTFahrenheit"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTRankineFromTFahrenheit">[docs]</a><span class="k">def</span> <span class="nf">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TFahrenheit</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to convert temperature to degree Rankine (°R)</span>
<span class="sd">    given temperature in degree Fahrenheit (°F).</span>

<span class="sd">    Args:</span>
<span class="sd">        TRankine: Temperature in degree Fahrenheit (°F)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Temperature in degree Rankine (°R)</span>

<span class="sd">    Reference:</span>
<span class="sd">        Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>

<span class="sd">    Notes:</span>
<span class="sd">        Exact conversion.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TRankine</span> <span class="o">=</span> <span class="n">TFahrenheit</span> <span class="o">+</span> <span class="n">ZERO_FAHRENHEIT_AS_RANKINE</span>
    <span class="k">return</span> <span class="n">TRankine</span></div>

<div class="viewcode-block" id="GetTFahrenheitFromTRankine"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTFahrenheitFromTRankine">[docs]</a><span class="k">def</span> <span class="nf">GetTFahrenheitFromTRankine</span><span class="p">(</span><span class="n">TRankine</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to convert temperature to degree Fahrenheit (°F)</span>
<span class="sd">    given temperature in degree Rankine (°R).</span>

<span class="sd">    Args:</span>
<span class="sd">        TRankine: Temperature in degree Rankine (°R)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Temperature in degree Fahrenheit (°F)</span>

<span class="sd">    Reference:</span>
<span class="sd">        Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>

<span class="sd">    Notes:</span>
<span class="sd">        Exact conversion.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TRankine</span> <span class="o">-</span> <span class="n">ZERO_FAHRENHEIT_AS_RANKINE</span></div>

<div class="viewcode-block" id="GetTKelvinFromTCelsius"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTKelvinFromTCelsius">[docs]</a><span class="k">def</span> <span class="nf">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TCelsius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to convert temperature to Kelvin (K)</span>
<span class="sd">    given temperature in degree Celsius (°C).</span>

<span class="sd">    Args:</span>
<span class="sd">        TCelsius: Temperature in degree Celsius (°C)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Temperature in Kelvin (K)</span>

<span class="sd">    Reference:</span>
<span class="sd">        Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>

<span class="sd">    Notes:</span>
<span class="sd">        Exact conversion.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TKelvin</span> <span class="o">=</span> <span class="n">TCelsius</span> <span class="o">+</span> <span class="n">ZERO_CELSIUS_AS_KELVIN</span>
    <span class="k">return</span> <span class="n">TKelvin</span></div>

<div class="viewcode-block" id="GetTCelsiusFromTKelvin"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTCelsiusFromTKelvin">[docs]</a><span class="k">def</span> <span class="nf">GetTCelsiusFromTKelvin</span><span class="p">(</span><span class="n">TKelvin</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to convert temperature to degree Celsius (°C)</span>
<span class="sd">    given temperature in Kelvin (K).</span>

<span class="sd">    Args:</span>
<span class="sd">        TKelvin: Temperature in Kelvin (K)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Temperature in degree Celsius (°C)</span>

<span class="sd">    Reference:</span>
<span class="sd">        Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>

<span class="sd">    Notes:</span>
<span class="sd">        Exact conversion.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TKelvin</span> <span class="o">-</span> <span class="n">ZERO_CELSIUS_AS_KELVIN</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Conversions between dew point, wet bulb, and relative humidity</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetTWetBulbFromTDewPoint"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTWetBulbFromTDewPoint">[docs]</a><span class="k">def</span> <span class="nf">GetTWetBulbFromTDewPoint</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return wet-bulb temperature given dry-bulb temperature, dew-point temperature, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TDewPoint : Dew-point temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Wet-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">TDewPoint</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dew point temperature is above dry bulb temperature&quot;</span><span class="p">)</span>

    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TWetBulb</span></div>

<div class="viewcode-block" id="GetTWetBulbFromRelHum"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTWetBulbFromRelHum">[docs]</a><span class="k">def</span> <span class="nf">GetTWetBulbFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return wet-bulb temperature given dry-bulb temperature, relative humidity, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        RelHum : Relative humidity in range [0, 1]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Wet-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Relative humidity is outside range [0, 1]&quot;</span><span class="p">)</span>

    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TWetBulb</span></div>

<div class="viewcode-block" id="GetRelHumFromTDewPoint"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetRelHumFromTDewPoint">[docs]</a><span class="k">def</span> <span class="nf">GetRelHumFromTDewPoint</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return relative humidity given dry-bulb temperature and dew-point temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TDewPoint : Dew-point temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Relative humidity in range [0, 1]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 22</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">TDewPoint</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dew point temperature is above dry bulb temperature&quot;</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
    <span class="n">SatVapPres</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
    <span class="n">RelHum</span> <span class="o">=</span> <span class="n">VapPres</span> <span class="o">/</span> <span class="n">SatVapPres</span>
    <span class="k">return</span> <span class="n">RelHum</span></div>

<div class="viewcode-block" id="GetRelHumFromTWetBulb"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetRelHumFromTWetBulb">[docs]</a><span class="k">def</span> <span class="nf">GetRelHumFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return relative humidity given dry-bulb temperature, wet bulb temperature and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TWetBulb : Wet-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Relative humidity in range [0, 1]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">TWetBulb</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wet bulb temperature is above dry bulb temperature&quot;</span><span class="p">)</span>

    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">RelHum</span> <span class="o">=</span>  <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">RelHum</span></div>

<div class="viewcode-block" id="GetTDewPointFromRelHum"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTDewPointFromRelHum">[docs]</a><span class="k">def</span> <span class="nf">GetTDewPointFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dew-point temperature given dry-bulb temperature and relative humidity.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        RelHum: Relative humidity in range [0, 1]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dew-point temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Relative humidity is outside range [0, 1]&quot;</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">)</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TDewPoint</span></div>

<div class="viewcode-block" id="GetTDewPointFromTWetBulb"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTDewPointFromTWetBulb">[docs]</a><span class="k">def</span> <span class="nf">GetTDewPointFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dew-point temperature given dry-bulb temperature, wet-bulb temperature, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TWetBulb : Wet-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dew-point temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">TWetBulb</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wet bulb temperature is above dry bulb temperature&quot;</span><span class="p">)</span>

    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TDewPoint</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Conversions between dew point, or relative humidity and vapor pressure</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetVapPresFromRelHum"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetVapPresFromRelHum">[docs]</a><span class="k">def</span> <span class="nf">GetVapPresFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return partial pressure of water vapor as a function of relative humidity and temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        RelHum : Relative humidity in range [0, 1]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 12, 22</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Relative humidity is outside range [0, 1]&quot;</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">RelHum</span> <span class="o">*</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">VapPres</span></div>

<div class="viewcode-block" id="GetRelHumFromVapPres"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetRelHumFromVapPres">[docs]</a><span class="k">def</span> <span class="nf">GetRelHumFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return relative humidity given dry-bulb temperature and vapor pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        VapPres: Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Relative humidity in range [0, 1]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 12, 22</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">VapPres</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Partial pressure of water vapor in moist air cannot be negative&quot;</span><span class="p">)</span>

    <span class="n">RelHum</span> <span class="o">=</span> <span class="n">VapPres</span> <span class="o">/</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">RelHum</span></div>

<div class="viewcode-block" id="dLnPws_"><a class="viewcode-back" href="../api_docs.html#psychrolib.dLnPws_">[docs]</a><span class="k">def</span> <span class="nf">dLnPws_</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function returning the derivative of the natural log of the saturation vapor pressure </span>
<span class="sd">    as a function of dry-bulb temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Derivative of natural log of vapor pressure of saturated air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1  eqn 5 &amp; 6</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_IP</span><span class="p">:</span>
            <span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">1.0214165E+04</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">5.3765794E-03</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1.9202377E-07</span> <span class="o">*</span> <span class="n">T</span> \
                  <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">3.5575832E-10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">9.0344688E-14</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">/</span> <span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">1.0440397E+04</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">2.7022355E-02</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1.2890360E-05</span> <span class="o">*</span> <span class="n">T</span> \
                  <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">2.4780681E-09</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">/</span> <span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_SI</span><span class="p">:</span>
            <span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">5.6745359E+03</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">9.677843E-03</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">6.2215701E-07</span> <span class="o">*</span> <span class="n">T</span> \
                  <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">2.0747825E-09</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">9.484024E-13</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">/</span> <span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">5.8002206E+03</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">4.8640239E-02</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">4.1764768E-05</span> <span class="o">*</span> <span class="n">T</span> \
                  <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">1.4452093E-08</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">/</span> <span class="n">T</span>

    <span class="k">return</span> <span class="n">dLnPws</span></div>

<div class="viewcode-block" id="GetTDewPointFromVapPres"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTDewPointFromVapPres">[docs]</a><span class="k">def</span> <span class="nf">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dew-point temperature given dry-bulb temperature and vapor pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        VapPres: Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dew-point temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 and 6</span>

<span class="sd">    Notes:</span>
<span class="sd">        The dew point temperature is solved by inverting the equation giving water vapor pressure</span>
<span class="sd">        at saturation from temperature rather than using the regressions provided</span>
<span class="sd">        by ASHRAE (eqn. 37 and 38) which are much less accurate and have a</span>
<span class="sd">        narrower range of validity.</span>
<span class="sd">        The Newton-Raphson (NR) method is used on the logarithm of water vapour</span>
<span class="sd">        pressure as a function of temperature, which is a very smooth function</span>
<span class="sd">        Convergence is usually achieved in 3 to 5 iterations. </span>
<span class="sd">        TDryBulb is not really needed here, just used for convenience.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">BOUNDS</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">148</span><span class="p">,</span> <span class="mi">392</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">BOUNDS</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>

    <span class="c1"># Validity check -- bounds outside which a solution cannot be found</span>
    <span class="k">if</span> <span class="n">VapPres</span> <span class="o">&lt;</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">BOUNDS</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="n">VapPres</span> <span class="o">&gt;</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">BOUNDS</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Partial pressure of water vapor is outside range of validity of equations&quot;</span><span class="p">)</span>

    <span class="c1"># We use NR to approximate the solution.</span>
    <span class="c1"># First guess</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">TDryBulb</span>        <span class="c1"># Calculated value of dew point temperatures, solved for iteratively</span>
    <span class="n">lnVP</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">VapPres</span><span class="p">)</span>    <span class="c1"># Partial pressure of water vapor in moist air</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">TDewPoint_iter</span> <span class="o">=</span> <span class="n">TDewPoint</span>   <span class="c1"># TDewPoint used in NR calculation</span>
        <span class="n">lnVP_iter</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint_iter</span><span class="p">))</span>

        <span class="c1"># Derivative of function, calculated analytically</span>
        <span class="n">d_lnVP</span> <span class="o">=</span> <span class="n">dLnPws_</span><span class="p">(</span><span class="n">TDewPoint_iter</span><span class="p">)</span>

        <span class="c1"># New estimate, bounded by the search domain defined above</span>
        <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">TDewPoint_iter</span> <span class="o">-</span> <span class="p">(</span><span class="n">lnVP_iter</span> <span class="o">-</span> <span class="n">lnVP</span><span class="p">)</span> <span class="o">/</span> <span class="n">d_lnVP</span>
        <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">BOUNDS</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">BOUNDS</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">TDewPoint</span> <span class="o">-</span> <span class="n">TDewPoint_iter</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">PSYCHROLIB_TOLERANCE</span><span class="p">)):</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">MAX_ITER_COUNT</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Convergence not reached in GetTDewPointFromVapPres. Stopping.&quot;</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TDewPoint</span></div>

<div class="viewcode-block" id="GetVapPresFromTDewPoint"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetVapPresFromTDewPoint">[docs]</a><span class="k">def</span> <span class="nf">GetVapPresFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return vapor pressure given dew point temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDewPoint : Dew-point temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 36</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">VapPres</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Conversions from wet-bulb temperature, dew-point temperature, or relative humidity to humidity ratio</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetTWetBulbFromHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTWetBulbFromHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return wet-bulb temperature given dry-bulb temperature, humidity ratio, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Wet-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 33 and 35 solved for Tstar</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio cannot be negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">BoundedHumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>

    <span class="c1"># Initial guesses</span>
    <span class="n">TWetBulbSup</span> <span class="o">=</span> <span class="n">TDryBulb</span>
    <span class="n">TWetBulbInf</span> <span class="o">=</span> <span class="n">TDewPoint</span>
    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="p">(</span><span class="n">TWetBulbInf</span> <span class="o">+</span> <span class="n">TWetBulbSup</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># Bisection loop</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">TWetBulbSup</span> <span class="o">-</span> <span class="n">TWetBulbInf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">PSYCHROLIB_TOLERANCE</span><span class="p">):</span>

        <span class="c1"># Compute humidity ratio at temperature Tstar</span>
        <span class="n">Wstar</span> <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>

        <span class="c1"># Get new bounds</span>
        <span class="k">if</span> <span class="n">Wstar</span> <span class="o">&gt;</span> <span class="n">BoundedHumRatio</span><span class="p">:</span>
            <span class="n">TWetBulbSup</span> <span class="o">=</span> <span class="n">TWetBulb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TWetBulbInf</span> <span class="o">=</span> <span class="n">TWetBulb</span>

        <span class="c1"># New guess of wet bulb temperature</span>
        <span class="n">TWetBulb</span> <span class="o">=</span> <span class="p">(</span><span class="n">TWetBulbSup</span> <span class="o">+</span> <span class="n">TWetBulbInf</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">MAX_ITER_COUNT</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Convergence not reached in GetTWetBulbFromHumRatio. Stopping.&quot;</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">TWetBulb</span></div>

<div class="viewcode-block" id="GetHumRatioFromTWetBulb"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetHumRatioFromTWetBulb">[docs]</a><span class="k">def</span> <span class="nf">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return humidity ratio given dry-bulb temperature, wet-bulb temperature, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TWetBulb : Wet-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 33 and 35</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">TWetBulb</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wet bulb temperature is above dry bulb temperature&quot;</span><span class="p">)</span>

    <span class="n">Wsstar</span> <span class="o">=</span> <span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
       <span class="k">if</span> <span class="n">TWetBulb</span> <span class="o">&gt;=</span> <span class="n">FREEZING_POINT_WATER_IP</span><span class="p">:</span>
           <span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1093</span> <span class="o">-</span> <span class="mf">0.556</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span> \
                    <span class="o">/</span> <span class="p">(</span><span class="mi">1093</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">)</span>
       <span class="k">else</span><span class="p">:</span>
           <span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1220</span> <span class="o">-</span> <span class="mf">0.04</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span> \
                    <span class="o">/</span> <span class="p">(</span><span class="mi">1220</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="mf">0.48</span><span class="o">*</span><span class="n">TWetBulb</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">if</span> <span class="n">TWetBulb</span> <span class="o">&gt;=</span> <span class="n">FREEZING_POINT_WATER_SI</span><span class="p">:</span>
           <span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mf">2501.</span> <span class="o">-</span> <span class="mf">2.326</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">1.006</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span> \
                    <span class="o">/</span> <span class="p">(</span><span class="mf">2501.</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="mf">4.186</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span>
       <span class="k">else</span><span class="p">:</span>
           <span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mf">2830.</span> <span class="o">-</span> <span class="mf">0.24</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">1.006</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span> \
                    <span class="o">/</span> <span class="p">(</span><span class="mf">2830.</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="mf">2.1</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span>
    <span class="c1"># Validity check.</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span></div>

<div class="viewcode-block" id="GetHumRatioFromRelHum"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetHumRatioFromRelHum">[docs]</a><span class="k">def</span> <span class="nf">GetHumRatioFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return humidity ratio given dry-bulb temperature, relative humidity, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        RelHum : Relative humidity in range [0, 1]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Relative humidity is outside range [0, 1]&quot;</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">)</span>
    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromVapPres</span><span class="p">(</span><span class="n">VapPres</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HumRatio</span></div>

<div class="viewcode-block" id="GetRelHumFromHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetRelHumFromHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return relative humidity given dry-bulb temperature, humidity ratio, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Relative humidity in range [0, 1]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio cannot be negative&quot;</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">RelHum</span> <span class="o">=</span> <span class="n">GetRelHumFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">RelHum</span></div>

<div class="viewcode-block" id="GetHumRatioFromTDewPoint"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetHumRatioFromTDewPoint">[docs]</a><span class="k">def</span> <span class="nf">GetHumRatioFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return humidity ratio given dew-point temperature and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDewPoint : Dew-point temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 13</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromVapPres</span><span class="p">(</span><span class="n">VapPres</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HumRatio</span></div>

<div class="viewcode-block" id="GetTDewPointFromHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTDewPointFromHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dew-point temperature given dry-bulb temperature, humidity ratio, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dew-point temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio cannot be negative&quot;</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TDewPoint</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Conversions between humidity ratio and vapor pressure</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetHumRatioFromVapPres"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetHumRatioFromVapPres">[docs]</a><span class="k">def</span> <span class="nf">GetHumRatioFromVapPres</span><span class="p">(</span><span class="n">VapPres</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return humidity ratio given water vapor pressure and atmospheric pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        VapPres : Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 20</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">VapPres</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Partial pressure of water vapor in moist air cannot be negative&quot;</span><span class="p">)</span>

    <span class="n">HumRatio</span> <span class="o">=</span> <span class="mf">0.621945</span> <span class="o">*</span> <span class="n">VapPres</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pressure</span> <span class="o">-</span> <span class="n">VapPres</span><span class="p">)</span>

    <span class="c1"># Validity check.</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span></div>

<div class="viewcode-block" id="GetVapPresFromHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetVapPresFromHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return vapor pressure given humidity ratio and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 20 solved for pw</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">Pressure</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.621945</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">VapPres</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Conversions between humidity ratio and specific humidity</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetSpecificHumFromHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetSpecificHumFromHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetSpecificHumFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the specific humidity from humidity ratio (aka mixing ratio).</span>

<span class="sd">    Args:</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Dry_Air⁻¹ [IP] or kg_H₂O kg_Dry_Air⁻¹ [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Specific humidity in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 9b</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio cannot be negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="n">SpecificHum</span> <span class="o">=</span> <span class="n">BoundedHumRatio</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SpecificHum</span></div>

<div class="viewcode-block" id="GetHumRatioFromSpecificHum"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetHumRatioFromSpecificHum">[docs]</a><span class="k">def</span> <span class="nf">GetHumRatioFromSpecificHum</span><span class="p">(</span><span class="n">SpecificHum</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the humidity ratio (aka mixing ratio) from specific humidity.</span>

<span class="sd">    Args:</span>
<span class="sd">        SpecificHum : Specific humidity in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Dry_Air⁻¹ [IP] or kg_H₂O kg_Dry_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 9b (solved for humidity ratio)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">SpecificHum</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">SpecificHum</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specific humidity is outside range [0, 1)&quot;</span><span class="p">)</span>

    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">SpecificHum</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">SpecificHum</span><span class="p">)</span>

    <span class="c1"># Validity check.</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Dry Air Calculations</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetDryAirEnthalpy"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetDryAirEnthalpy">[docs]</a><span class="k">def</span> <span class="nf">GetDryAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dry-air enthalpy given dry-bulb temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dry air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 28</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">DryAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="n">TDryBulb</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DryAirEnthalpy</span> <span class="o">=</span> <span class="mi">1006</span> <span class="o">*</span> <span class="n">TDryBulb</span>
    <span class="k">return</span> <span class="n">DryAirEnthalpy</span></div>

<div class="viewcode-block" id="GetDryAirDensity"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetDryAirDensity">[docs]</a><span class="k">def</span> <span class="nf">GetDryAirDensity</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dry-air density given dry-bulb temperature and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dry air density in lb ft⁻³ [IP] or kg m⁻³ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    Notes:</span>
<span class="sd">        Eqn 14 for the perfect gas relationship for dry air.</span>
<span class="sd">        Eqn 1 for the universal gas constant.</span>
<span class="sd">        The factor 144 in IP is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">DryAirDensity</span> <span class="o">=</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span> <span class="o">/</span> <span class="n">R_DA_IP</span> <span class="o">/</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DryAirDensity</span> <span class="o">=</span> <span class="n">Pressure</span> <span class="o">/</span> <span class="n">R_DA_SI</span> <span class="o">/</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DryAirDensity</span></div>

<div class="viewcode-block" id="GetDryAirVolume"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetDryAirVolume">[docs]</a><span class="k">def</span> <span class="nf">GetDryAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dry-air volume given dry-bulb temperature and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dry air volume in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    Notes:</span>
<span class="sd">        Eqn 14 for the perfect gas relationship for dry air.</span>
<span class="sd">        Eqn 1 for the universal gas constant.</span>
<span class="sd">        The factor 144 in IP is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">DryAirVolume</span> <span class="o">=</span> <span class="n">R_DA_IP</span> <span class="o">*</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DryAirVolume</span> <span class="o">=</span> <span class="n">R_DA_SI</span> <span class="o">*</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pressure</span>
    <span class="k">return</span> <span class="n">DryAirVolume</span></div>


<div class="viewcode-block" id="GetTDryBulbFromEnthalpyAndHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTDryBulbFromEnthalpyAndHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetTDryBulbFromEnthalpyAndHumRatio</span><span class="p">(</span><span class="n">MoistAirEnthalpy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dry bulb temperature from enthalpy and humidity ratio.</span>


<span class="sd">    Args:</span>
<span class="sd">        MoistAirEnthalpy : Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30</span>

<span class="sd">    Notes:</span>
<span class="sd">        Based on the `GetMoistAirEnthalpy` function, rearranged for temperature.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">TDryBulb</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">-</span> <span class="mf">1061.0</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.240</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">TDryBulb</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">-</span> <span class="mf">2501.0</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.006</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TDryBulb</span></div>

<div class="viewcode-block" id="GetHumRatioFromEnthalpyAndTDryBulb"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetHumRatioFromEnthalpyAndTDryBulb">[docs]</a><span class="k">def</span> <span class="nf">GetHumRatioFromEnthalpyAndTDryBulb</span><span class="p">(</span><span class="n">MoistAirEnthalpy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return humidity ratio from enthalpy and dry-bulb temperature.</span>


<span class="sd">    Args:</span>
<span class="sd">        MoistAirEnthalpy : Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Based on the `GetMoistAirEnthalpy` function, rearranged for humidity ratio.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">HumRatio</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">-</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1061.0</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">HumRatio</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">-</span> <span class="mf">1.006</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2501.0</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span>

    <span class="c1"># Validity check.</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Saturated Air Calculations</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetSatVapPres"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetSatVapPres">[docs]</a><span class="k">def</span> <span class="nf">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return saturation vapor pressure given dry-bulb temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Vapor pressure of saturated air in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1  eqn 5 &amp; 6</span>
<span class="sd">        Important note: the ASHRAE formulae are defined above and below the freezing point but have</span>
<span class="sd">        a discontinuity at the freezing point. This is a small inaccuracy on ASHRAE&#39;s part: the formulae</span>
<span class="sd">        should be defined above and below the triple point of water (not the feezing point) in which case</span>
<span class="sd">        the discontinuity vanishes. It is essential to use the triple point of water otherwise function</span>
<span class="sd">        GetTDewPointFromVapPres, which inverts the present function, does not converge properly around</span>
<span class="sd">        the freezing point.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">148</span> <span class="ow">or</span> <span class="n">TDryBulb</span> <span class="o">&gt;</span> <span class="mi">392</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dry bulb temperature must be in range [-148, 392]°F&quot;</span><span class="p">)</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_IP</span><span class="p">):</span>
            <span class="n">LnPws</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0214165E+04</span> <span class="o">/</span> <span class="n">T</span> <span class="o">-</span> <span class="mf">4.8932428</span> <span class="o">-</span> <span class="mf">5.3765794E-03</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.9202377E-07</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> \
                  <span class="o">+</span> <span class="mf">3.5575832E-10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">9.0344688E-14</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LnPws</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0440397E+04</span> <span class="o">/</span> <span class="n">T</span> <span class="o">-</span> <span class="mf">1.1294650E+01</span> <span class="o">-</span> <span class="mf">2.7022355E-02</span><span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.2890360E-05</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> \
                  <span class="o">-</span> <span class="mf">2.4780681E-09</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">100</span> <span class="ow">or</span> <span class="n">TDryBulb</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dry bulb temperature must be in range [-100, 200]°C&quot;</span><span class="p">)</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_SI</span><span class="p">):</span>
            <span class="n">LnPws</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.6745359E+03</span> <span class="o">/</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">6.3925247</span> <span class="o">-</span> <span class="mf">9.677843E-03</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">6.2215701E-07</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> \
                  <span class="o">+</span> <span class="mf">2.0747825E-09</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">9.484024E-13</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LnPws</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.8002206E+03</span> <span class="o">/</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.3914993</span> <span class="o">-</span> <span class="mf">4.8640239E-02</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">4.1764768E-05</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> \
                  <span class="o">-</span> <span class="mf">1.4452093E-08</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

    <span class="n">SatVapPres</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">LnPws</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SatVapPres</span></div>

<div class="viewcode-block" id="GetSatHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetSatHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetSatHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return humidity ratio of saturated air given dry-bulb temperature and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio of saturated air in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 36, solved for W</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">SatVaporPres</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
    <span class="n">SatHumRatio</span> <span class="o">=</span> <span class="mf">0.621945</span> <span class="o">*</span> <span class="n">SatVaporPres</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pressure</span> <span class="o">-</span> <span class="n">SatVaporPres</span><span class="p">)</span>

    <span class="c1"># Validity check.</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">SatHumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span></div>

<div class="viewcode-block" id="GetSatAirEnthalpy"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetSatAirEnthalpy">[docs]</a><span class="k">def</span> <span class="nf">GetSatAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return saturated air enthalpy given dry-bulb temperature and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb: Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure: Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Saturated air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">SatHumRatio</span> <span class="o">=</span> <span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">SatAirEnthalpy</span> <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">SatHumRatio</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SatAirEnthalpy</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Moist Air Calculations</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetVaporPressureDeficit"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetVaporPressureDeficit">[docs]</a><span class="k">def</span> <span class="nf">GetVaporPressureDeficit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return Vapor pressure deficit given dry-bulb temperature, humidity ratio, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Vapor pressure deficit in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        Oke (1987) eqn 2.13a</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>

    <span class="n">RelHum</span> <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">VaporPressureDeficit</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">RelHum</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">VaporPressureDeficit</span></div>

<div class="viewcode-block" id="GetDegreeOfSaturation"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetDegreeOfSaturation">[docs]</a><span class="k">def</span> <span class="nf">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the degree of saturation (i.e humidity ratio of the air / humidity ratio of the air at saturation</span>
<span class="sd">    at the same temperature and pressure) given dry-bulb temperature, humidity ratio, and atmospheric pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Degree of saturation in arbitrary unit</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2009) ch. 1 eqn 12</span>

<span class="sd">    Notes:</span>
<span class="sd">        This definition is absent from the 2017 Handbook. Using 2009 version instead.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="n">SatHumRatio</span> <span class="o">=</span> <span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">DegreeOfSaturation</span> <span class="o">=</span> <span class="n">BoundedHumRatio</span> <span class="o">/</span> <span class="n">SatHumRatio</span>
    <span class="k">return</span> <span class="n">DegreeOfSaturation</span></div>

<div class="viewcode-block" id="GetMoistAirEnthalpy"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetMoistAirEnthalpy">[docs]</a><span class="k">def</span> <span class="nf">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return moist air enthalpy given dry-bulb temperature and humidity ratio.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1061</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.006</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2501.</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="k">return</span> <span class="n">MoistAirEnthalpy</span></div>

<div class="viewcode-block" id="GetMoistAirVolume"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetMoistAirVolume">[docs]</a><span class="k">def</span> <span class="nf">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return moist air specific volume given dry-bulb temperature, humidity ratio, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Specific volume of moist air in ft³ lb⁻¹ of dry air [IP] or in m³ kg⁻¹ of dry air [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 26</span>

<span class="sd">    Notes:</span>
<span class="sd">        In IP units, R_DA_IP / 144 equals 0.370486 which is the coefficient appearing in eqn 26</span>
<span class="sd">        The factor 144 is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">R_DA_IP</span> <span class="o">*</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">R_DA_SI</span> <span class="o">*</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pressure</span>
    <span class="k">return</span> <span class="n">MoistAirVolume</span></div>

<div class="viewcode-block" id="GetTDryBulbFromMoistAirVolumeAndHumRatio"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetTDryBulbFromMoistAirVolumeAndHumRatio">[docs]</a><span class="k">def</span> <span class="nf">GetTDryBulbFromMoistAirVolumeAndHumRatio</span><span class="p">(</span><span class="n">MoistAirVolume</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return dry-bulb temperature given moist air specific volume, humidity ratio, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        MoistAirVolume: Specific volume of moist air in ft³ lb⁻¹ of dry air [IP] or in m³ kg⁻¹ of dry air [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 26</span>

<span class="sd">    Notes:</span>
<span class="sd">        In IP units, R_DA_IP / 144 equals 0.370486 which is the coefficient appearing in eqn 26</span>
<span class="sd">        The factor 144 is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>
<span class="sd">        Based on the `GetMoistAirVolume` function, rearranged for dry-bulb temperature.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">TDryBulb</span> <span class="o">=</span> <span class="n">GetTFahrenheitFromTRankine</span><span class="p">(</span><span class="n">MoistAirVolume</span> <span class="o">*</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">R_DA_IP</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">TDryBulb</span> <span class="o">=</span> <span class="n">GetTCelsiusFromTKelvin</span><span class="p">(</span><span class="n">MoistAirVolume</span> <span class="o">*</span> <span class="n">Pressure</span>
                        <span class="o">/</span> <span class="p">(</span><span class="n">R_DA_SI</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">TDryBulb</span></div>

<div class="viewcode-block" id="GetMoistAirDensity"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetMoistAirDensity">[docs]</a><span class="k">def</span> <span class="nf">GetMoistAirDensity</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return moist air density given humidity ratio, dry bulb temperature, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        HumRatio : Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        MoistAirDensity: Moist air density in lb ft⁻³ [IP] or kg m⁻³ [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 11</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Humidity ratio is negative&quot;</span><span class="p">)</span>
    <span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>

    <span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">BoundedHumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">MoistAirDensity</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">MoistAirVolume</span>
    <span class="k">return</span> <span class="n">MoistAirDensity</span></div>


<span class="c1">#######################################################################################################</span>
<span class="c1"># Standard atmosphere</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="GetStandardAtmPressure"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetStandardAtmPressure">[docs]</a><span class="k">def</span> <span class="nf">GetStandardAtmPressure</span><span class="p">(</span><span class="n">Altitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return standard atmosphere barometric pressure, given the elevation (altitude).</span>

<span class="sd">    Args:</span>
<span class="sd">        Altitude: Altitude in ft [IP] or m [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Standard atmosphere barometric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 3</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">StandardAtmPressure</span> <span class="o">=</span> <span class="mf">14.696</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">6.8754e-06</span> <span class="o">*</span> <span class="n">Altitude</span><span class="p">,</span> <span class="mf">5.2559</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">StandardAtmPressure</span> <span class="o">=</span> <span class="mi">101325</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">2.25577e-05</span> <span class="o">*</span> <span class="n">Altitude</span><span class="p">,</span> <span class="mf">5.2559</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">StandardAtmPressure</span></div>

<div class="viewcode-block" id="GetStandardAtmTemperature"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetStandardAtmTemperature">[docs]</a><span class="k">def</span> <span class="nf">GetStandardAtmTemperature</span><span class="p">(</span><span class="n">Altitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return standard atmosphere temperature, given the elevation (altitude).</span>

<span class="sd">    Args:</span>
<span class="sd">        Altitude: Altitude in ft [IP] or m [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Standard atmosphere dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 4</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="n">StandardAtmTemperature</span> <span class="o">=</span> <span class="mi">59</span> <span class="o">-</span> <span class="mf">0.00356620</span> <span class="o">*</span> <span class="n">Altitude</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">StandardAtmTemperature</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">-</span> <span class="mf">0.0065</span> <span class="o">*</span> <span class="n">Altitude</span>
    <span class="k">return</span> <span class="n">StandardAtmTemperature</span></div>

<div class="viewcode-block" id="GetSeaLevelPressure"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetSeaLevelPressure">[docs]</a><span class="k">def</span> <span class="nf">GetSeaLevelPressure</span><span class="p">(</span><span class="n">StationPressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return sea level pressure given dry-bulb temperature, altitude above sea level and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        StationPressure : Observed station pressure in Psi [IP] or Pa [SI]</span>
<span class="sd">        Altitude: Altitude in ft [IP] or m [SI]</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sea level barometric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        Hess SL, Introduction to theoretical meteorology, Holt Rinehart and Winston, NY 1959,</span>
<span class="sd">        ch. 6.5; Stull RB, Meteorology for scientists and engineers, 2nd edition,</span>
<span class="sd">        Brooks/Cole 2000, ch. 1.</span>

<span class="sd">    Notes:</span>
<span class="sd">        The standard procedure for the US is to use for TDryBulb the average</span>
<span class="sd">        of the current station temperature and the station temperature from 12 hours ago.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">isIP</span><span class="p">():</span>
        <span class="c1"># Calculate average temperature in column of air, assuming a lapse rate</span>
        <span class="c1"># of 3.6 °F/1000ft</span>
        <span class="n">TColumn</span> <span class="o">=</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="mf">0.0036</span> <span class="o">*</span> <span class="n">Altitude</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Determine the scale height</span>
        <span class="n">H</span> <span class="o">=</span> <span class="mf">53.351</span> <span class="o">*</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TColumn</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Calculate average temperature in column of air, assuming a lapse rate</span>
        <span class="c1"># of 6.5 °C/km</span>
        <span class="n">TColumn</span> <span class="o">=</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="mf">0.0065</span> <span class="o">*</span> <span class="n">Altitude</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Determine the scale height</span>
        <span class="n">H</span> <span class="o">=</span> <span class="mf">287.055</span> <span class="o">*</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TColumn</span><span class="p">)</span> <span class="o">/</span> <span class="mf">9.807</span>

    <span class="c1"># Calculate the sea level pressure</span>
    <span class="n">SeaLevelPressure</span> <span class="o">=</span> <span class="n">StationPressure</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Altitude</span> <span class="o">/</span> <span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SeaLevelPressure</span></div>

<div class="viewcode-block" id="GetStationPressure"><a class="viewcode-back" href="../api_docs.html#psychrolib.GetStationPressure">[docs]</a><span class="k">def</span> <span class="nf">GetStationPressure</span><span class="p">(</span><span class="n">SeaLevelPressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return station pressure from sea level pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        SeaLevelPressure : Sea level barometric pressure in Psi [IP] or Pa [SI]</span>
<span class="sd">        Altitude: Altitude in ft [IP] or m [SI]</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Station pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Reference:</span>
<span class="sd">        See &#39;GetSeaLevelPressure&#39;</span>

<span class="sd">    Notes:</span>
<span class="sd">        This function is just the inverse of &#39;GetSeaLevelPressure&#39;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">StationPressure</span> <span class="o">=</span> <span class="n">SeaLevelPressure</span> <span class="o">/</span> <span class="n">GetSeaLevelPressure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">StationPressure</span></div>


<span class="c1">######################################################################################################</span>
<span class="c1"># Functions to set all psychrometric values</span>
<span class="c1">#######################################################################################################</span>

<div class="viewcode-block" id="CalcPsychrometricsFromTWetBulb"><a class="viewcode-back" href="../api_docs.html#psychrolib.CalcPsychrometricsFromTWetBulb">[docs]</a><span class="k">def</span> <span class="nf">CalcPsychrometricsFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to calculate humidity ratio, dew-point temperature, relative humidity,</span>
<span class="sd">    vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given</span>
<span class="sd">    dry-bulb temperature, wet-bulb temperature, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TWetBulb : Wet-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Dew-point temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Relative humidity in range [0, 1]</span>
<span class="sd">        Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<span class="sd">        Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<span class="sd">        Specific volume of moist air in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<span class="sd">        Degree of saturation [unitless]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">RelHum</span> <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span>
    <span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">DegreeOfSaturation</span> <span class="o">=</span> <span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">,</span> <span class="n">MoistAirEnthalpy</span><span class="p">,</span> <span class="n">MoistAirVolume</span><span class="p">,</span> <span class="n">DegreeOfSaturation</span></div>

<div class="viewcode-block" id="CalcPsychrometricsFromTDewPoint"><a class="viewcode-back" href="../api_docs.html#psychrolib.CalcPsychrometricsFromTDewPoint">[docs]</a><span class="k">def</span> <span class="nf">CalcPsychrometricsFromTDewPoint</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to calculate humidity ratio, wet-bulb temperature, relative humidity,</span>
<span class="sd">    vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given</span>
<span class="sd">    dry-bulb temperature, dew-point temperature, and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        TDewPoint : Dew-point temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Wet-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Relative humidity in range [0, 1]</span>
<span class="sd">        Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<span class="sd">        Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<span class="sd">        Specific volume of moist air in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<span class="sd">        Degree of saturation [unitless]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">RelHum</span> <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span>
    <span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">DegreeOfSaturation</span> <span class="o">=</span> <span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">,</span> <span class="n">MoistAirEnthalpy</span><span class="p">,</span> <span class="n">MoistAirVolume</span><span class="p">,</span> <span class="n">DegreeOfSaturation</span></div>

<div class="viewcode-block" id="CalcPsychrometricsFromRelHum"><a class="viewcode-back" href="../api_docs.html#psychrolib.CalcPsychrometricsFromRelHum">[docs]</a><span class="k">def</span> <span class="nf">CalcPsychrometricsFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to calculate humidity ratio, wet-bulb temperature, dew-point temperature,</span>
<span class="sd">    vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given</span>
<span class="sd">    dry-bulb temperature, relative humidity and pressure.</span>

<span class="sd">    Args:</span>
<span class="sd">        TDryBulb : Dry-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        RelHum : Relative humidity in range [0, 1]</span>
<span class="sd">        Pressure : Atmospheric pressure in Psi [IP] or Pa [SI]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<span class="sd">        Wet-bulb temperature in °F [IP] or °C [SI]</span>
<span class="sd">        Dew-point temperature in °F [IP] or °C [SI].</span>
<span class="sd">        Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<span class="sd">        Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<span class="sd">        Specific volume of moist air in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<span class="sd">        Degree of saturation [unitless]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span>
    <span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="n">DegreeOfSaturation</span> <span class="o">=</span> <span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">,</span> <span class="n">MoistAirEnthalpy</span><span class="p">,</span> <span class="n">MoistAirVolume</span><span class="p">,</span> <span class="n">DegreeOfSaturation</span></div>


<span class="c1"># This section provides support for vectorization through the use of the Numba library (http://numba.pydata.org/)</span>
<span class="c1"># If Numba is not installed, the library just works with scalars and vectorization is simply not supported </span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">isfunction</span>
    <span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span><span class="p">,</span> <span class="n">njit</span>

    <span class="n">has_numba</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># Needs to compile as used in vectorized functions below.</span>
    <span class="n">isIP</span> <span class="o">=</span> <span class="n">njit</span><span class="p">(</span><span class="n">isIP</span><span class="p">)</span>
    <span class="c1"># Vectorise all &#39;core&#39; functions. </span>
    <span class="c1"># Utility function are excluded as they are just wrappers.</span>
    <span class="n">func_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">isfunction</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s1">&#39;Get&#39;</span><span class="p">,</span> <span class="s1">&#39;dLnPws_&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">func</span> <span class="o">!=</span> <span class="s1">&#39;GetUnitSystem&#39;</span><span class="p">:</span>
            <span class="nb">globals</span><span class="p">()[</span><span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">vectorize</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">func_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">has_numba</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, D. Thevenard and D. Meyer.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>